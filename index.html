<!DOCTYPE html>
<html>

<head>
    <style>
        * {
            padding: 0px;
            margin: 0px;
        }

        .main {
            width: 100vw;
            height: 100vh;
            background-color: #1B1B1C;
        }

        .arrow {
            position: absolute;
            width: 60vw;
            height: 60vw;
            left: 20vw;
        }


        .arrow svg {
            width: 100%;
            height: 100%;
            fill: #3C3B3D;
        }

        .arrow-disabled svg {
            fill: #282729 !important;
        }

        .arrow-disabled svg path:hover {
            fill: #282729 !important;
        }

        .arrow-correct svg {
            fill: #64D842 !important;
        }

        .arrow-correct svg path:hover {
            fill: #64D842 !important;
        }

        .arrow-incorrect svg {
            fill: #D44343 !important;
        }

        .arrow-incorrect svg path:hover {
            fill: #D44343 !important;
        }

        .arrow svg path:hover {
            fill: #4d4c4e;
        }

        #up-arrow {
            top: calc((100vh - 120vw) / 2);
        }

        #down-arrow {
            top: calc(((100vh - 120vw) / 2) + 60vw);
        }
    </style>
</head>

<body>
    <div class="main">
        <p id="status-text"></p>
        
        <div class="arrow" id="up-arrow">
            <svg xmlns="http://www.w3.org/2000/svg" width="499" height="433" viewBox="0 0 499 433">
                <path id="UpArrow"
                    d="M236.5,22.556a15,15,0,0,1,25.994,0L486.042,410.511a15,15,0,0,1-13,22.489H25.955a15,15,0,0,1-13-22.489Z" />
            </svg>

        </div>

        <div class="arrow" id="down-arrow">
            <svg xmlns="http://www.w3.org/2000/svg" width="499" height="433" viewBox="0 0 499 433">
                <path id="DownArrow"
                    d="M236.5,22.556a15,15,0,0,1,25.994,0L486.042,410.511a15,15,0,0,1-13,22.489H25.955a15,15,0,0,1-13-22.489Z"
                    transform="translate(499 433) rotate(180)" />
            </svg>
        </div>
    </div>


    <script src="simpleTones.js"></script>
    <script>
        function Log(x, base) { return Math.log(x) / Math.log(base); }

        // https://en.wikipedia.org/wiki/Twelfth_root_of_two
        // https://music.stackexchange.com/questions/81620/calculation-of-a-notes-frequency-in-the-18th-19th-century
        // Where NoteFrequency(x) is the frequency of the note in Hertz, and x is the number of semitones your note is above Middle C (C4).
        function FrequencyFromNote(x) { x = x == 0 ? 0.00001 : x; return 440 * ((2 ** (1 / 12)) ** (x - 9)); }

        // Where NoteFromFrequency(x) is the number of semitones above middle C, and x is the frequency in Hertz. The two formulae above are equivalent.
        function NoteFromFrequency(x) { return Log((x / 440), 2 ** (1 / 12)) + 9; }

        // Logarithmic Interpolation
        // https://www.cmu.edu/biolphys/deserno/pdf/log_interpol.pdf
        function LogarithmicInterpolation(x1, x2, x) {
            return (Math.log(x2) - Math.log(x)) / (Math.log(x) - Math.log(x1));
        }

        // 1 Cent = 1/100 of a semi-tone.
        // http://hyperphysics.phy-astr.gsu.edu/hbase/Music/cents.html#c2
        function CalculateCentInterval(f1, f2) {
            return
        }

    </script>
    <script>
        statusText = document.getElementById("status-text");
        upArrow = document.getElementById("up-arrow");
        downArrow = document.getElementById("down-arrow");
        correctAnswer = "none"

        function StartRound() {
            upArrow.classList = "arrow arrow-disabled"
            downArrow.classList = "arrow arrow-disabled"

            firstTone = tone["C4"]
            secondTone = tone["E4"]
            correctAnswer = secondTone > firstTone ? "sharp" : "flat";

            centDelta = Math.round(Math.abs(NoteFromFrequency(secondTone) - NoteFromFrequency(firstTone)) * 100)
            console.log(centDelta)
            statusText.innerHTML = centDelta

            //playTone(firstTone)
            setTimeout(() => {
                //playTone(secondTone)
                upArrow.classList = "arrow"
                downArrow.classList = "arrow"
            }, 1750);
        }

        function Guess(answer) {
            if (upArrow.classList != "arrow" || downArrow.classList != "arrow") { return }

            upArrow.classList = (answer == correctAnswer) ? "arrow arrow-correct" : "arrow arrow-incorrect";
            downArrow.classList = (answer == correctAnswer) ? "arrow arrow-correct" : "arrow arrow-incorrect";

            setTimeout(() => { StartRound() }, 1500);
        }

        upArrow.addEventListener('click', event => { Guess("sharp"); });
        downArrow.addEventListener('click', event => { Guess("flat"); });

        StartRound();
    </script>
</body>

</html>